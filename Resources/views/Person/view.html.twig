{#
 * Copyright (C) 2014, Champs Libres Cooperative SCRLFS, <http://www.champs-libres.coop>
 *
 * This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 *  License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
#}
{% extends "ChillPersonBundle::layout.html.twig"  %}

{% set activeRouteKey = 'chill_person_view' %}

{#
This view should receive those arguments:
- person
#}

{% block title %}ChillPersonBundle:Person:see{% endblock %}
{#
    we define variables to include an edit form repeated multiple time across
    the page
#}
{% set edit_tmp_name = 'ChillPersonBundle:Form:go_to_form.html.twig'  %}
{% set edit_tmp_args = { 'form_path_args' : { 'person_id': person.id }, 
      'form_path_key' : 'chill_person_general_edit' } %}


{% block personcontent %}


{{ include(edit_tmp_name, edit_tmp_args) }}

<figure>
    <h2>{{ 'views.Person.view.general'|trans }}</h2>
    
    <dl>
        <dt class="inline">{{ 'First name'|trans }}</dt>
        <dd>{{ person.firstName }}</dd>
        
        <dt class="inline">{{ 'Last name'|trans }}</dt>
        <dd>{{ person.lastName }}</dd>
        
        <dt class="inline">{{ 'views.Person.view.gender'|trans }}</dt>
        <dd>{{ ( 'person.gender.' ~ person.genre|default('undefined'))|trans }}</dd>
    </dl>
</figure>

<figure>
    <h2>{{ 'views.Person.view.birth'|trans }}</h2>

    <dl>
            <dt class="inline">{{ 'views.Person.view.dateOfBirth'|trans }}</dt>
            <dd>{{ person.dateOfBirth.format(date_format)
                |default( 'person.without_date_of_birth'|trans ) }}</dd>

            
            <dt class="inline">{{ 'views.Person.view.placeOfBirth'|trans }}</dt>
            <dd>{{ person.placeOfBirth }}</dd>
            <dd>{% spaceless %}  
                
                {% if person.countryOfBirth is not null %}
                    {{ person.countryOfBirth.name|localize_translatable_string }}
                {% else %}
                    {{ 'views.Person.view.country_of_birth_unknow'|trans }}
                {% endif %}

{% endspaceless %}</dd>
            
        
    </dl>
</figure>

{{ include(edit_tmp_name, edit_tmp_args) }}

<figure>
    <h2>{{ 'views.Person.view.administrative'|trans }}</h2>

    <dl>
      <dt class="inline">{{ 'views.Person.view.nationality'|trans }}</dt>
        <dd>
            {% if person.nationality is not null %}
                {{ person.nationality.name|localize_translatable_string }}
            {% else %}
                {{ 'views.Person.view.without_nationality'|trans }}
            {% endif %}
        </dd> 
    </dl>
</figure>

{{ include(edit_tmp_name, edit_tmp_args) }}

<figure>
    <h2>{{ 'views.Person.view.contact'|trans }}</h2>

    <dl>
        <dt class="inline">{{ 'views.Person.view.email'|trans }}</dt>
        <dd><pre>{{ person.email}}&nbsp;</pre></dd>
    </dl>
    <dl>
        <dt class="inline">{{ 'views.Person.view.phonenumber'|trans }}</dt>
        <dd><pre>{{ person.phonenumber}}&nbsp;</pre></dd>
    </dl>

</figure>

{{ include(edit_tmp_name, edit_tmp_args) }}

{% if cFGroup  %}
    <figure>
        {% for customField in cFGroup.customFields %}
            {% if customField.type == 'title' %}
                {{ chill_custom_field_widget(person.cFData , customField) }}
            {% else %}
                <dt>{{ chill_custom_field_label(customField) }}</dt>
                <dd>{{ chill_custom_field_widget(person.cFData , customField) }}</dd> 
            {% endif %}
        {% endfor %}
    </figure>

    {{ include(edit_tmp_name, edit_tmp_args) }}
    
{% endif %}

{% endblock %}
